---
layout: post
title: "Next Malware? Maybe"
date: 2021-07-25 17:00:00 +0700
category: hacks
author: minh
tags: mining malware
short-description: It's not new, but it's Vietnamese
---

*Disclaimer: Mình nên bỏ cái kiểu để title tiếng Anh xong content bằng tiếng Việt như thế này*

Post này cách post trước tầm 3 tháng. Qua 3 tháng vừa rồi, mình đã đào được một số coin nhất định, cũng có một vài kinh nghiệm nhất định trong "nghề crypto", cũng như một vài skillset nhất định để cuộc sống của mình đơn giản hơn. Nội dung của post này một phần là nối tiếp của post trước, một phần là, hình như mình đã tìm ra một attack target mới, mình nghĩ vậy.

# Current situation

Ở post trước, mình có sử dụng KVM tạo VM để chạy miner. Có một người anh đã bảo mình là anh ấy chạy docker container thì sẽ dễ dàng hơn, không cần phải passthrough làm gì. Điều đó đúng, rất đúng. Việc làm như vậy sẽ đỡ tốn thời gian passthrough hơn và không bị CPU penalty. Dù sao thì việc chạy miner cũng không tốn CPU lắm để mà lo về penalty, nhưng đó cũng là một ý hay.

Sau post đó, mình có nói rằng ở use case cụ thể của mình, mình cần phải cài Windows để cài driver unlock cho RTX 3060 thì mới có thể lên được 48MH/s. Hơn nữa, khi cắm GPU vào case Workstation, nó khá nóng, vì vậy, mình đã mua thùng case 4U để dedicate cho việc đào coin này. Nó đã chạy được 3 tháng khá ổn định.

# What's new?

Docker, GPU, ... Kubernetes? Các bạn biết mình đang nói về cái gì rồi chứ? Trong trường hợp không biết, thì mình sẽ giải thích:

1. Kubernetes là một công cụ tự động hóa mạnh, nhiệm vụ của nó là sẽ chạy những docker container đã được định nghĩa sẵn, thực hiện theo kịch bản.
2. Docker Container là một công cụ nhắm tới việc triển khai những dịch vụ microservice một cách dễ dàng, với mức tiêu thụ tài nguyên tối thiểu.
3. GPU nếu không mua được ... thì mình đi thuê, chẳng hạn thế. 

Hiện nay, các Cloud Provider khá là "hào phóng" khi cho mọi người thuê VM có GPU với giá khá rẻ. Bạn có thể thuê một VM có GPU rồi mang nó ra đào coin. Khá nhiều người quen của mình đã làm như vậy, họ thuê Compute VPS để plot Chia chẳng hạn.

Vấn đề quan trọng là, làm sao để quản lý nhiều VM GPU. Oke, có thể tạo một VM có nhiều GPU chẳng hạn, nhưng hiện tại, một VM có thể có nhiều nhất 4 GPU. Giả sử, giá ETH tăng lên 10k$ chẳng hạn, và bạn muốn thuê tầm 10 VM GPU, thì làm sao để quản lý nó? Bạn có thể sử dụng `ansible` để deploy VM một cách nhanh chóng, nhưng giả sử một VM bị lỗi, thì bạn sẽ phải tìm ra VM đó là gì và sửa nó một cách thủ công.

Giải pháp của mình hiện tại là mình sẽ sử dụng Kubernetes. Khi sử dụng Kubernetes trên Cloud, bạn có thể tự động tăng số lượng VM instance nếu cần thiết, và giảm số lượng instance với chỉ một nút bấm. Nghe có vẻ là một cách để có thu nhập thụ động đấy nhỉ. Có vẻ đúng là như thế thật.

Việc này không mới, thực tế, hồi 2017 (có thể google ra bài blog đó khá dễ), khi ETH tăng mạnh thì đã có những người bắt đầu sử dụng tech stack này để thuê GPU đào coin. Đến năm 2018, ETH crash thì "trò" này không được ai nhắc đến nữa.

Ý tưởng là như vậy, rõ ràng là có thể thực hiện được chỉ với một vài dòng code. Vấn đề ở đây là khi nào thì thuê máy? Tính toán chi phí thế nào thì chạy đào coin có lãi. Bởi nếu không lãi, thì đi mua coin rồi HODL luôn cho rồi.

# Khi IT đi tính ROI?

Khi mua máy đào coin, bạn cần tính toán đến việc tản nhiệt cho dàn đào và tiền điện để chạy miner, cũng như bao lâu thì sẽ hòa vốn. Ngược lại, khi thuê máy đào, bạn chỉ cần quan tâm tới việc thuê máy hết bao nhiêu và nó sẽ đào được bao nhiêu tiền. Nếu số tiền đào được cao hơn thì là có lãi, nếu nhỏ hơn thì đi mua coin luôn cho nhanh, hoặc bỏ luôn coin nếu không có đam mê hay niềm tin gì với crypto nữa.

Nếu mỗi thế thôi thì đã dễ, mình sẽ chẳng việc gì phải chia sẻ "cần câu cơm" của mình miễn phí cho tất cả mọi người như thế này. Không biết nữa, chắc là mình đã tạo nghiệp nhiều quá nên có thể đây là một cách để mình cảm thấy thanh thản hơn chẳng hạn. ~~For the record, I still want to marry you~~

Cơ mà, bài post này lại liên quan đến Malware? WTF?

# Brain-wash

Okay, hear me out! Giả sử, bạn không phải trả tiền để thuê máy đào coin thì sao? I mean, not even a dime.

Nếu đọc đến phần này rồi thì hãy quên tất cả những gì mình viết ở trên đi. Tính ROI làm gì cho mệt khi mà nguồn tiền đến một cách thụ động theo nghĩa đen. 

Nếu inference service của một business nào đó bị leak cred chẳng hạn, thì rõ ràng là có thể dùng luôn nó làm miner. Tuyệt vời hơn nữa, nếu có thể thay đổi configuration script của một scale set có GPU thì rõ ràng là chỉ cần đợi tiền về một cách thụ động...

# Kết

Dù sao thì EIP-1559 cũng sắp đến, với rate hiện tại thì việc thuê GPU một cách chính thống cũng chẳng thể nào có lãi được. Biết đâu, trong tương lai sẽ có một đồng coin khác áp dụng được cách này thì sao. Việc viết blog thế này có thể khiến mình bị sụt giảm số lượng instance có thể thuê được, nhưng điều đó có phải thú vị hơn sao, mình sẽ càng ngày càng phát triển bản thân để có thêm nhiều skill mới.