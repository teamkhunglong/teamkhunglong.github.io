<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Getting started with Kubernetes" /><meta name="author" content="Minh Tran" /><meta property="og:locale" content="en" /><meta name="description" content="TL;DR Blog cực kì xiao lone, bạn nên đọc trên blog kubernetes.io để có được content đầy đủ nhất" /><meta property="og:description" content="TL;DR Blog cực kì xiao lone, bạn nên đọc trên blog kubernetes.io để có được content đầy đủ nhất" /><link rel="canonical" href="https://blog.teamkhunglong.com/posts/getting-started-with-Kubernetes/" /><meta property="og:url" content="https://blog.teamkhunglong.com/posts/getting-started-with-Kubernetes/" /><meta property="og:site_name" content="Team Khủng Long" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-01T04:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Getting started with Kubernetes" /><meta name="twitter:site" content="@minhtt159" /><meta name="twitter:creator" content="@minhtt159" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Minh Tran","url":"https://github.com/minhtt159/"},"dateModified":"2022-07-13T12:57:29+02:00","datePublished":"2021-04-01T04:00:00+02:00","description":"TL;DR Blog cực kì xiao lone, bạn nên đọc trên blog kubernetes.io để có được content đầy đủ nhất","headline":"Getting started with Kubernetes","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.teamkhunglong.com/posts/getting-started-with-Kubernetes/"},"url":"https://blog.teamkhunglong.com/posts/getting-started-with-Kubernetes/"}</script><title>Getting started with Kubernetes | Team Khủng Long</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Team Khủng Long"><meta name="application-name" content="Team Khủng Long"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/raws/khunglong_w.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Team Khủng Long</a></div><div class="site-subtitle font-italic">Modern problems require modern solutions</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/minhtt159" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/minhtt159" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Getting started with Kubernetes</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Getting started with Kubernetes</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1617242400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 1, 2021 </em> </span> <span> Updated <em class="" data-ts="1657709849" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 13, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/minhtt159/">Minh Tran</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2564 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><p>TL;DR Blog cực kì xiao lone, bạn nên đọc trên blog <a href="https://kubernetes.io/docs/home/">kubernetes.io</a> để có được content đầy đủ nhất</p><p>Tiếp tục câu chuyện về tập đoàn tư bản hàng đầu VN, anh lead mình bắt mình viết một cái guide kiểu Getting Started with Kubernetes, nên mình viết chiếc blog này. Cũng là để giới thiệu với những bạn nào mới muốn nhún chân vào làm về Kubernetes thì có thể hiểu được nó có những cái gì.</p><p>Dù website gốc có rất nhiều thông tin, mình sẽ chỉ tóm gọn lại rất cơ bản những thứ mình thích nói vào blog ở đây, như một cách giới thiệu về concept của Kubernetes.</p><p>Đây là bài 1 trong chuỗi series về Kubernetes được dịch và tóm gọn lại từ website gốc.</p><h1 id="ý-tưởng-về-kubernetes">Ý tưởng về Kubernetes</h1><p>Tại đây, mình sẽ giới thiệu các khái niệm cơ bản để hiểu rõ hơn về hệ thống cũng như các tính năng khái quát của một mạng Kubernetes. Từ đó, bạn có thể hiểu sâu hơn về cách vận hành của nó.</p><h2 id="tổng-quát"><span class="mr-2">Tổng quát</span><a href="#tổng-quát" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Phần này sẽ làm rõ về tổng quan một hệ thống Kubernetes và các thành phần tạo nên nó.</p><h3 id="kubernetes-là-gì"><span class="mr-2">Kubernetes là gì?</span><a href="#kubernetes-là-gì" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Kubernetes là một nền tàng (platform) mã nguồn mở, dễ dàng sử dụng cũng như mở rộng. Nhiệm vụ của Kubernetes là quản lý các công việc qua container hoặc quản lý các dịch vụ, dễ dàng tự động hoá cũng như cấu hình dịch vụ / công việc. Các dịch vụ, công cụ của Kubernetes được phổ biến và hỗ trợ rộng rãi.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="/assets/img/2021/04/container_evolution.svg" alt="" title="Container Evolution" height="100%" width="100%" data-proofer-ignore></p><p>Ngày xưa, các dịch vụ được chạy trên những server vật lý. Giả sử, nếu hai dịch vụ cùng chạy trên 1 server vật lý, nếu một dịch vụ dùng hết tài nguyên của hệ thống, dịch vụ kia sẽ không còn tài nguyên để chạy. Để khắc phục vấn đề này, mỗi dịch vụ sẽ phải chạy trên những server vật lý khác nhau. Việc mua thêm server vật lý có thể là một lời giải cồng kềnh, hơn nữa, còn phải nuôi nhiều nhân công để quản lý server vật lý.</p><p>Khi đó, công nghệ ảo hoá được sinh ra. Thay vì phải sử dụng nhiều server vật lý, ta chỉ cần dùng một server có sức mạnh lớn hơn, và chia tài nguyên cho từng máy ảo (VM). Mỗi máy ảo sẽ có đủ tính năng của một server vật lý bình thường, bao gồm cả một hệ điều hành hoàn chỉnh.</p><p>Hiện tại, nếu nhiều dịch vụ chỉ được phân chia vào từng VM như thiết kế cũ, nhưng môi trường hoạt động của chúng giống nhau (ví dụ cùng chạy trên Ubuntu 64-bit 18.04 LTS) thì phần tài nguyên để quản lý hệ điều hành sẽ bị lãng phí. Công nghệ Container sinh ra để giải quyết vấn đề này, bao gồm có những tính năng về chia sẻ CPU, RAM, file, … như công nghệ ảo hoá nhưng lại khắc phục được điểm yếu khi phải quản lý cả hệ điều hành.</p><p>Ngoài ra, công nghệ container còn ưu việt hơn ở một số điểm:</p><ul><li>Tạo và triển khai ứng dụng theo công nghệ Agile dễ hơn so với VM.<li>Quản lý CI/CD dễ dàng, tự động hơn so với VM.<li>Có nhiều thang đo thông tin hơn so với VM, ví dụ như trạng thái của dịch vụ.<li>Nhất quán về môi trường chạy dịch vụ (it works on my machine)<li>Dễ dàng dựng trên các hệ thống khác nhau: vật lý (on-premise) hay cloud (Amazon, Microsoft, Google) với mọi loại hệ điều hành (Ubuntu, Windows)<li>Các dịch vụ được quản lý phân tán, thay vì tập trung như VM.</ul><h4 id="dùng-kubernetes-khi-nào"><span class="mr-2">Dùng Kubernetes khi nào?</span><a href="#dùng-kubernetes-khi-nào" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Container là một cách tối ưu khi phát triển dịch vụ. Giả sử, bạn cần quản lý n-dịch vụ và không được có downtime, nhưng một dịch vụ chết, thì Kubernetes sẽ tự động cung cấp dịch vụ mới, thậm chí có thể không có downtime. Kubernetes có thể mở rộng quy mô của dịch vụ hay tạo thêm những dịch vụ dự phòng một cách dễ dàng.</p><p>Các tính năng của Kubernetes:</p><ul><li>Quản lý dịch vụ và cân bằng tải: Kubernetes có thể cung cấp dịch vụ ra mạng ngoài qua DNS name của dịch vụ. Nếu một dịch vụ đang gặp lưu lượng mạng lớn (high traffic), kubernetes có thể cân bằng tải lưu lượng mạng qua những node dịch vụ khác.<li>Điều phối lưu trữ: Có thể dễ dàng tích hợp hệ thống lưu trữ vào mạng Kubernetes, ví dụ như ổ cứng vật lý hay dữ liệu trên cloud.<li>Tự động triển khai và khôi phục (rollout &amp; rollback): Kubernetes có thể tự động triển khai một phiên bản mới của dịch vụ và thu hồi tài nguyên của phiên bản cũ, cũng như khôi phục lại theo yêu cầu.<li>Tự động lựa chọn tài nguyên: Kubernetes có thể nhận yêu cầu về tài nguyên (RAM, CPU) và chia sẻ vào các cụm Node phù hợp để chạy dịch vụ đó.<li>Tự sửa chữa: Nếu một dịch vụ không hoạt động đúng theo kịch bản hoặc chết (fail health check), Kubernetes có thể xoá bỏ container đó và tạo một container mới.<li>Quản lý thông số và mật mã: Kubernetes có thể quản lý các thông tin về mật khẩu, OAuth token, SSH Keys một cách tự động và sẽ chỉ cung cấp thông tin khi được cho phép.</ul><h4 id="những-điểm-khác-biệt-giữa-kubernetes-và-hệ-thống-truyền-thống"><span class="mr-2">Những điểm khác biệt giữa Kubernetes và hệ thống truyền thống</span><a href="#những-điểm-khác-biệt-giữa-kubernetes-và-hệ-thống-truyền-thống" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Một hệ thống từ trước đến nay thường là một thể thống nhất. Ví dụ những tính năng như triển khai mã nguồn, mở rộng quy mô, cân bằng tải, ghi nhật kí, giám sát, cảnh báo thường được tích hợp trong một khối; thì Kubernetes sẽ hướng tới việc module hoá các công việc trên. Như kiểu chơi lego vậy.</p><p>Những thứ cần lưu ý khi dùng Kubernetes:</p><ul><li>Nếu ứng dụng chạy được bằng Container, thì sẽ chạy được trên Kubernetes. Những công việc xử lý được rất đa dạng, kể cả những công việc stateless / stateful (<a href="https://www.redhat.com/en/topics/cloud-native-apps/stateful-vs-stateless">tham khảo</a>) hay tác vụ xử lý dữ liệu.<li>Không cung cấp những dịch vụ ở cấp ứng dụng ví dụ như hệ thống xử lý dữ liệu (như Spark), hay cơ sở dữ liệu (như MySQL), hệ thống lưu trữ (như Ceph) một cách mặc định. Nhưng những ứng dụng này vẫn có thể được dựng và chạy trên mạng Kubernetes.<li>Không yêu cầu mặc định các phương pháp giám sát hoặc cảnh báo, nhưng có thể tích hợp với các phương pháp chuyên nghiệp hơn để thu thập và trích xuất các thông tin cần thiết.<li>Không bắt buộc phải dùng cấu hình ngôn ngữ/hệ thống, mọi API có thể được định nghĩa tuỳ ý.<li>Không cung cấp bất kì hệ thống cấu hình, bảo trì, quản lý, tự sửa chữa một cách toàn diện nào.<li>Không phải hệ thống điều phối đơn thuần, Kubernetes bao gồm các quy trình điểu khiển độc lập và có thể kết hợp được dễ dàng.</ul><h3 id="thành-phần-của-kubernetes"><span class="mr-2">Thành phần của Kubernetes</span><a href="#thành-phần-của-kubernetes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Khi bạn triển khai một mạng <code class="language-plaintext highlighter-rouge">Kubernetes</code>, bạn sẽ có một <code class="language-plaintext highlighter-rouge">Cluster</code>. Cluster bao gồm một hoặc nhiều worker, gọi là <code class="language-plaintext highlighter-rouge">Node</code>. Mỗi node sẽ chạy một hoặc nhiều ứng dụng được <code class="language-plaintext highlighter-rouge">containerized</code>.</p><p>Mỗi worker node có nhiệm vụ chạy các <code class="language-plaintext highlighter-rouge">Pods</code>. Một Pod là một container đang được chạy, một công việc có thể yêu cầu một hoặc nhiều Pod.</p><p>Lớp quản lý của mạng Kubernetes gọi là <code class="language-plaintext highlighter-rouge">Control Plane</code>, mình hay gọi là <code class="language-plaintext highlighter-rouge">server node</code> để phân biệt với <code class="language-plaintext highlighter-rouge">worker node</code>. Trong khi worker node làm nhiệm vụ chạy các công việc được yêu cầu, thì server node chỉ làm nhiệm vụ quản lý.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="/assets/img/2021/04/components-of-kubernetes.svg" alt="" title="Components of Kubernetes" height="100%" width="100%" data-proofer-ignore></p><p>Trong môi trường production, một hệ thống Kubernetes thường có nhiều <code class="language-plaintext highlighter-rouge">server node</code> và <code class="language-plaintext highlighter-rouge">worker node</code>, cung cấp sự sẵn sàng cao (high availability - HA). Trong thực tế, mình thường có 2 server node và 3 worker node.</p><h4 id="thành-phần-quản-lý"><span class="mr-2">Thành phần quản lý</span><a href="#thành-phần-quản-lý" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Thành phần quản lý sẽ đảm nhiệm việc đưa ra các quyết định cho một mạng Cluster, cũng như phát hiện và phản ứng trước một sự kiện nào đó trọng mạng. Ví dụ, ta muốn tạo 2 service front-end và sử dụng cân bằng tải thì sẽ phải đăng kí với <code class="language-plaintext highlighter-rouge">control plane</code>. Thành phần quản lý gồm các thành phần con như sau:</p><h5 id="kube-apiserver"><span class="mr-2">kube-apiserver</span><a href="#kube-apiserver" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Cung cấp chính các API trong mạng Kubernetes. Đây là front-end của Cluster. kube-api được thiết kế để mở rộng theo chiều ngang, có nghĩa là bạn có thể chạy nhiều kube-apiserver trên nhiều máy khác nhau và cân bằng lưu lượng mạng giữa các API server đó.</p><h5 id="etcd"><span class="mr-2">etcd</span><a href="#etcd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Là một nơi lưu trữ thông tin của mạng Kubernetes. Có thể sử dụng để lưu mật khẩu, OAuth token, SSH Keys, docker cred …</p><p>Do là nơi lưu trữ thông tin nên hoàn toàn có thể sử dụng cơ sử dữ liệu bên ngoài khác ví dụ như MySQL.</p><h5 id="kube-scheduler"><span class="mr-2">kube-scheduler</span><a href="#kube-scheduler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Nhiệm vụ chính của Scheduler là phân chia các Pod vào các Worker node một cách hợp lý. Ví dụ 1 Worker node có 16GB ram, khi ta chạy 3 Pod, Pod thứ 3 sẽ được phân chia vào một Worker node khác nếu còn tài nguyên.</p><h5 id="kube-controller-manager"><span class="mr-2">kube-controller-manager</span><a href="#kube-controller-manager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Nhiệm vụ của Controller là để xử lý các công việc khác nhau:</p><ul><li>Node Controller: chịu trách nhiệm thông báo &amp; phản hồi nếu một node bị chết.<li>Job Controller: thực hiện và giám sát các Job, tạo một hoặc nhiều Pod tương ứng để thực hiện Job theo yêu cầu.<li>Endpoints Sontroller: kết nối các thành phần dịch vụ và pod (ví dụ như gán IP ngoài tới hệ thống cân bằng tải, sau đó nối đến front-end)<li>Service Account &amp; Token controllers: cung cấp các thông tin được lưu trong etcd đến các Pod nếu có yêu cầu.</ul><h5 id="cloud-controller-manager"><span class="mr-2">cloud-controller-manager</span><a href="#cloud-controller-manager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Là thành phần kết nối Cluster đến các Cloud Provider. Những hệ thống ví dụ như Azure Kubernetes Service (AKS) sẽ có nhiều tính năng liên quan đến thành phần này. Ví dụ để kết nối AKS với ACR (Azure Container Registry) mà không cần đăng nhập qua Docker. Hoặc ví dụ để kết nối đến các load balancer của Cloud.</p><h4 id="thành-phần-trên-mỗi-worker-node"><span class="mr-2">Thành phần trên mỗi worker node</span><a href="#thành-phần-trên-mỗi-worker-node" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Trên mỗi worker node sẽ gồm có 2 thành phần, làm nhiệm vụ nhận lệnh từ server node và duy trì các Pod.</p><h5 id="kube-proxy"><span class="mr-2">kube-proxy</span><a href="#kube-proxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Là một network-proxy, làm nhiệm vụ duy trì kết nối mạng trong Node, giúp truyền tải các gói tin trong và ngoại Node</p><h5 id="kubelet"><span class="mr-2">kubelet</span><a href="#kubelet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>Là <code class="language-plaintext highlighter-rouge">Agent Pod</code> chạy trên mỗi node, làm nhiệm vụ chạy các container. Kubelet sẽ lấy cấu hình <code class="language-plaintext highlighter-rouge">PodSpec</code> được nhận từ server node và dựng lên những Pod với cấu hình đó, đảm bảo việc Pod được chạy ổn định.</p><h4 id="container-runtime"><span class="mr-2">Container runtime</span><a href="#container-runtime" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Là một phần mềm đảm nhiệm môi trường container. Có thể là Docker, <a href="https://containerd.io/docs/">containerd</a>, <a href="https://cri-o.io/">CRI-O</a>, …</p><h4 id="addon"><span class="mr-2">Addon</span><a href="#addon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Là các dịch vụ khác của Kubernetes như DaemonSets, Deployments, … thường nằm trong namespace kube-system. Những tính năng thường có bao gồm:</p><ol><li>DNS: serve DNS records (chịu, không tìm được từ Tiếng Việt)<li>WebUI: giao diện Web để dễ quản lý (thậm chí từ điện thoại)<li>Resource Monitoring: quản lý tài nguyên, hiển thị các thông số hệ thống, thường được tích hợp trong giao diện Web.<li>Cluster-level Logging: self-explained :shrug:</ol><h3 id="kubernetes-api"><span class="mr-2">Kubernetes API</span><a href="#kubernetes-api" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>API, là thành phần core trong Kubernetes, được cung cấp cho người dùng để tương tác với đối tượng (object) trong Kubernetes. Người dùng, những như các Node sẽ tương tác với mạng Kubernetes qua các API này.</p><p>Có thể kể đến <code class="language-plaintext highlighter-rouge">kubectl</code> hay <code class="language-plaintext highlighter-rouge">kubeadm</code> là những tool rất tiện lợi để tương tác với Kubernetes Cluster.</p><h3 id="đối-tượng-trong-kubernetes"><span class="mr-2">Đối tượng trong Kubernetes</span><a href="#đối-tượng-trong-kubernetes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="kubernetes-object-là-gì"><span class="mr-2">Kubernetes Object là gì</span><a href="#kubernetes-object-là-gì" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Kubernetes Object là một thực thể cụ thể trong hệ thống Kubernetes, những thực thể này mô tả trạng thái của Cluster. Cụ thể hơn:</p><ul><li>Ứng dụng nào đang được chạy, và được chạy trong Node nào.<li>Tài nguyên có sẵn cho các ứng dụng.<li>Các luật được áp dụng cho ứng dụng. Ví dụ như khả năng tự khởi động lại, tự sửa lỗi, hay tự nâng cấp.</ul><p>Kubernetes Object có 2 trường cần lưu ý là <code class="language-plaintext highlighter-rouge">Spec</code> và <code class="language-plaintext highlighter-rouge">Status</code>.</p><ul><li>Spec: trang thái mong muốn của đối tượng. Ví dụ: ứng dụng này sẽ triển khai docker images nginx.<li>Status: trạng thái hiện tại của đối tượng. Ví dụ: ứng dụng này có 1 phiên bản đang được chạy, 2 phiên bản khác đang được triển khai.</ul><p>Tìm hiểu thêm về việc mô tả (describe) một đối tượng ở <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/#describing-a-kubernetes-object">đây</a></p><h4 id="quản-lý-kubernetes-object"><span class="mr-2">Quản lý Kubernetes Object</span><a href="#quản-lý-kubernetes-object" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Trong đa số trường hợp, chúng ta sẽ sử dụng công cụ <code class="language-plaintext highlighter-rouge">kubectl</code> để quản lý các đối tượng trong mạng Kubernetes. Có 3 cách để điều khiển một đối tượng:</p><ol><li>Imperative commands: sử dụng câu lệnh để điều khiển trực tiếp đối tượng.<li>Imperative object configuration: sử dụng file cấu hình để điều khiển đối tượng.<li>Declarative object configuration: sử dụng tập hợp các file cấu hình để điều khiển một hoặc nhiều đối tượng.</ol><h4 id="name--id"><span class="mr-2">Name &amp; ID</span><a href="#name--id" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Name và ID được sinh ra để phân biệt giữa các đối tượng trong một loại tài nguyên cụ thể. Ví dụ:</p><ul><li>2 Pod không thể cùng tên là <code class="language-plaintext highlighter-rouge">myapp-123</code><li>Pod có thể tên là <code class="language-plaintext highlighter-rouge">myapp-123</code> và Deployment hay Job đồng thời cũng có thể tên là <code class="language-plaintext highlighter-rouge">myapp-123</code></ul><p>Để truy cập vào đối tượng này, có thể sử dụng API tại <code class="language-plaintext highlighter-rouge">/api/v1/pods/some-name</code>.</p><h4 id="namespace"><span class="mr-2">Namespace</span><a href="#namespace" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Namespace được sinh ra với nhiệm vụ làm một môi trường ảo, phân biệt với môi trường thật. Giả sử ta chỉ có 1 Cluster vật lý, nhưng lại có 2 môi trường Dev và Prodcution, thì ta có thể tạo ra 2 namespace để phân biệt 2 môi trường với nhau.</p><p>Có thể xem những namespace với câu lệnh <code class="language-plaintext highlighter-rouge">kubectl get namespace</code></p><p>Lưu ý, có những đối tượng <code class="language-plaintext highlighter-rouge">nằm trong namespace</code> ví dụ như mạng ảo; nhưng lại có những đối tượng <code class="language-plaintext highlighter-rouge">không nằm trong namespace</code> ví dụ như storage.</p><h4 id="label--selector"><span class="mr-2">Label &amp; Selector</span><a href="#label--selector" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Label là một cặp <code class="language-plaintext highlighter-rouge">key-value</code> để quản lý đối tượng dễ hơn, cụ thể hơn so với <code class="language-plaintext highlighter-rouge">namespace</code>. Thêm nữa, người dùng có thể tự tạo label một cách tuỳ ý. Ví dụ:</p><ul><li>“release” : “stable”, “release” : “canary”<li>“environment” : “dev”, “environment” : “qa”, “environment” : “production”<li>“tier” : “frontend”, “tier” : “backend”, “tier” : “cache”<li>“partition” : “customerA”, “partition” : “customerB”<li>“track” : “daily”, “track” : “weekly”</ul><p>Có thể sử dụng Selector hay NodeSelector để chỉ định Pod sẽ được chạy trên một node nào đó phù hợp.</p><h4 id="annotaion"><span class="mr-2">Annotaion</span><a href="#annotaion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Giống với Label, nhưng Annotation hướng đến những metadata lớn hơn và tự động so với Label. Ví dụ:</p><ul><li>Thông tin về timestamps, release IDs, git branch, PR numbers, image hashes, và registry address :shrug:<li>Các endpoint về nhật kí, giám sát hoặc cảnh báo.<li>Các thông tin về phiên bản thư viện 3rd party.<li>Vân vân, …</ul><h1 id="kết-luận">Kết luận</h1><p>Bài blog này đã giới thiệu qua một số thuật ngữ trong Kubernetes cũng như một vài use case khi nào nên sử dụng Kubernetes. Bài blog tiếp theo trong chuỗi series có thể sẽ nói về các ý tưởng về Container hay Workload, những real case scenario khi triển khai một công việc DevOps. #GLHF</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/operations/'>operations</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/operations/" class="post-tag no-text-decoration" >operations</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Getting+started+with+Kubernetes+-+Team+Kh%E1%BB%A7ng+Long&url=https%3A%2F%2Fblog.teamkhunglong.com%2Fposts%2Fgetting-started-with-Kubernetes%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Getting+started+with+Kubernetes+-+Team+Kh%E1%BB%A7ng+Long&u=https%3A%2F%2Fblog.teamkhunglong.com%2Fposts%2Fgetting-started-with-Kubernetes%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.teamkhunglong.com%2Fposts%2Fgetting-started-with-Kubernetes%2F&text=Getting+started+with+Kubernetes+-+Team+Kh%E1%BB%A7ng+Long" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/how-to-build-v8-old-version/">How to build v8 (but old version)</a><li><a href="/posts/how-to-build-a-blog-like-this/">How to build a blog like this</a><li><a href="/posts/whoami/">whoami</a><li><a href="/posts/SVATTT-online-merklision/">SVATTT 2020 Online - Merklision</a><li><a href="/posts/how-to-DevOps/">How to DevOps 101</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/operations/">operations</a> <a class="post-tag" href="/tags/mining/">mining</a> <a class="post-tag" href="/tags/development/">development</a> <a class="post-tag" href="/tags/devops/">devops</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/amd/">amd</a> <a class="post-tag" href="/tags/asrock/">asrock</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/javascript/">javascript</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/how-to-DevOps/"><div class="card-body"> <em class="small" data-ts="1617156000" data-df="ll" > Mar 31, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to DevOps 101</h3><div class="text-muted small"><p> ref: link 1 link 2 Giới thiệu Blog này viết dựa trên bài ref ở trên, bên cạnh đó mình sẽ biến đổi một chút để phù hợp hơn với use case của mình. Dù sao, mình cũng phải làm việc viết doc này do le...</p></div></div></a></div><div class="card"> <a href="/posts/what-do-you-need-to-devops/"><div class="card-body"> <em class="small" data-ts="1615906200" data-df="ll" > Mar 16, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>What do you need to DevOps?</h3><div class="text-muted small"><p> Đây sẽ là một series thập cẩm tiếng anh / tiếng việt chẳng ra gì nhưng mà là nơi để mình lưu lại các trải nghiệm về devops. Những bài trong blog này được tham khảo bởi nhiê...</p></div></div></a></div><div class="card"> <a href="/posts/how-to-mine-with-kubernetes/"><div class="card-body"> <em class="small" data-ts="1630893600" data-df="ll" > Sep 6, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to mine with kubernetes</h3><div class="text-muted small"><p> Intro TL;DR: ghcr-tictactoe Ở post trước, mình có đề cập tới việc chạy miner sử dụng Kubernetes on cloud. Mình đã từng chạy thử và nó hoàn toàn có thể thực hiện được chỉ qua vài dòng code, nhiều ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-DevOps/" class="btn btn-outline-primary" prompt="Older"><p>How to DevOps 101</p></a> <a href="/posts/crypto-mining/" class="btn btn-outline-primary" prompt="Newer"><p>Crypto Mining</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "teamkhunglong/teamkhunglong.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMDQyMTEyMDU=", "data-category": "Q&A", "data-category-id": "MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyODI0NTUy", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/minhtt159">Minh Tran</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/operations/">operations</a> <a class="post-tag" href="/tags/mining/">mining</a> <a class="post-tag" href="/tags/development/">development</a> <a class="post-tag" href="/tags/devops/">devops</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/amd/">amd</a> <a class="post-tag" href="/tags/asrock/">asrock</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/github/">github</a> <a class="post-tag" href="/tags/javascript/">javascript</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
